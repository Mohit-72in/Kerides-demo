### ====================================================
### GLOBAL VARIABLES
### ====================================================
@baseUrl = http://localhost:3000

# --- User Credentials ---
@userEmail = test_user_global@app.com
@userPassword = secureUserPwd123

# --- Driver Credentials ---
@driverEmail = test_driver_global@app.com
@driverPassword = secureDriverPwd123
@vehicleId = 

### ====================================================
### 1. USER AUTHENTICATION & PROFILE
### ====================================================

### 1.1 User Signup (CENTRALIZED)
POST {{baseUrl}}/auth/user/signup
Content-Type: application/json

{
    "name": "Global Test User",
    "email": "{{userEmail}}",
    "password": "{{userPassword}}"
}

###

### 1.2 User Login (Capture JWT) (CENTRALIZED)
# @name userLogin
POST {{baseUrl}}/auth/user/login
Content-Type: application/json

{
    "email": "{{userEmail}}",
    "password": "{{userPassword}}"
}

###

### Extract user token from login response
@userToken = {{userLogin.response.body.access_token}}

### 1.3 Protected: Get User List (Retrieval)
GET {{baseUrl}}/users/userList
X-Token: {{userToken}}

###

### 1.4 Unprotected: Get User Details by Email
GET {{baseUrl}}/users/userDetails/{{userEmail}}

###

### 1.5 Protected: Update User Profile (User Controller route)
POST {{baseUrl}}/users/update
X-Token: {{userToken}}
Content-Type: application/json

{
    "name": "Updated Global Test User",
    "email": "updated_test_user_global@app.com"
}
# NOTE: Removed phone field as it's not in CreateUserDto.

###

### 1.6 User Logout (REMOVED - No endpoint implemented)


### ====================================================
### 2. DRIVER AUTHENTICATION & PROFILE
### ====================================================

### 2.1 Driver Signup (CENTRALIZED)
POST {{baseUrl}}/auth/driver/signup
Content-Type: application/json

{
    "name": "Global Test Driver",
    "email": "{{driverEmail}}",
    "phone": 9991112220,
    "password": "{{driverPassword}}",
    "drivinglicenseNo": "DL-99988877",
    "agreement": true
}

###

### 2.2 Driver Login (Capture JWT) (CENTRALIZED)
# @name driverLogin
POST {{baseUrl}}/auth/driver/login
Content-Type: application/json

{
    "email": "{{driverEmail}}",
    "password": "{{driverPassword}}"
}

###

### Extract driver token from login response
@driverToken = {{driverLogin.response.body.access_token}}

###

### 2.3 Protected: Get Driver List
GET {{baseUrl}}/drivers/list
X-Token: {{driverToken}}

###

### 2.4 Protected: Get Driver Own Details (Profile retrieval)
GET {{baseUrl}}/drivers/details
X-Token: {{driverToken}}

###

### 2.5 Protected: Update Driver Profile (Name/Phone Update)
POST {{baseUrl}}/drivers/update
X-Token: {{driverToken}}
Content-Type: application/json

{
    "name": "Prakash Sharma",
    "phone": 9998887770 
}

###

### 2.6 Protected: Update Driver's Personal Info (Nested data)
POST {{baseUrl}}/drivers/updatePersonalInfo
X-Token: {{driverToken}}
Content-Type: application/json

{
    "personalInfo": {
        "city": "Mumbai",
        "maritalStatus": "Single"
    }
}

### 2.7 Driver Logout (REMOVED - No endpoint implemented)


### ====================================================
### 3. VEHICLE MANAGEMENT (NEW MODULE TEST)
### ====================================================
# NOTE: This section is CRUCIAL to verify the new module.

### 3.1 Protected: Register New Vehicle (Capture vehicleId)
# @name registerVehicle
POST {{baseUrl}}/vehicles
X-Token: {{driverToken}}
Content-Type: application/json

{
    "make": "Toyota",
    "vehicleModel": "Innova",
    "year": 2021,
    "seatsNo": 6,
    "licensePlate": "MH12AC{{$randomInt}}", 
    "vehicleClass": "SUV",
    "vehicleType": "premium",
    "fareStructure": {
        "minimumFare": 100,
        "perKilometerRate": 15,
        "waitingChargePerMinute": 2,
        "cancellationFee": 50
    }
}
# Note: Use $randomInt to ensure unique licensePlate for testing

### Extract vehicle ID from creation response
@vehicleId = {{registerVehicle.response.body.vehicle._id}}

###

### 3.2 Protected: Update Vehicle Details  693a657737c506704ab707f2
 PUT {{baseUrl}}/vehicles/{{vehicleId}}


X-Token: {{driverToken}}
Content-Type: application/json

{
    "fareStructure": {
        "minimumFare": 120,
        "perKilometerRate": 18,
        "waitingChargePerMinute": 3,
        "cancellationFee": 60
    }
}

###

### 3.3 Protected: Get Driver's Vehicle List
GET {{baseUrl}}/vehicles/my-list
X-Token: {{driverToken}}

###

### 3.4 Public: Get All Vehicles List
GET {{baseUrl}}/vehicles